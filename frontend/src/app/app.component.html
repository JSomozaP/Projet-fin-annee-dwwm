<!-- Navigation Header -->
<header class="navbar">
  <div class="navbar-container">
    <!-- Logo & Brand -->
    <div class="navbar-brand">
      <h1 class="brand-logo">
        <span class="brand-name">Streamyscovery</span>
        <span class="brand-tagline">Discover â€¢ Connect â€¢ Explore</span>
      </h1>
    </div>

    <!-- Navigation Links (desktop) -->
    <nav class="navbar-nav">
      <a routerLink="/discovery" routerLinkActive="nav-active" class="nav-link" (click)="closeMobileMenu()">
        <i class="icon-discover"></i>
        DÃ©couvrir
      </a>
      <a class="nav-link" *ngIf="isAuthenticated" (click)="openQuests()">
        <i class="icon-quest"></i>
        QuÃªtes
      </a>
      <a routerLink="/favorites" routerLinkActive="nav-active" class="nav-link" *ngIf="isAuthenticated" (click)="closeMobileMenu()">
        <i class="icon-heart"></i>
        Favoris
        <span class="badge" *ngIf="favoriteCount > 0">{{ favoriteCount }}</span>
      </a>
      
      <!-- ğŸ“Š Analytics Premium - VIP et Legendary seulement -->
      <a routerLink="/analytics" routerLinkActive="nav-active" class="nav-link analytics-link" *ngIf="isAuthenticated && hasAnalyticsAccess" (click)="closeMobileMenu()">
        ğŸ“Š Analytics
        <span class="premium-badge">{{currentTier.badge}}</span>
      </a>
      
      <a routerLink="/subscription" routerLinkActive="nav-active" class="nav-link premium-link" (click)="closeMobileMenu()">
        ğŸ† Premium <span class="rotating-star">âœ¨</span>
      </a>
    </nav>

    <!-- User Actions -->
    <div class="navbar-actions">
      <ng-container *ngIf="!isAuthenticated">
        <button class="btn btn-outline" (click)="login()">
          <i class="icon-twitch"></i>
          Se connecter
        </button>
      </ng-container>
      
      <ng-container *ngIf="isAuthenticated && user">
        <div class="user-menu">
          <div class="user-avatar">
            <img [src]="user.avatar_url || getDefaultUserAvatar(user.username)" [alt]="user.username" (error)="onUserAvatarError($event, user.username)">
          </div>
          <span class="user-name clickable-username" (click)="openUserProfile()">{{ user.username }}</span>
          <button class="btn btn-ghost" (click)="logout()">
            <i class="icon-logout"></i>
          </button>
        </div>
      </ng-container>
    </div>
    
    <!-- Mobile menu button -->
    <button class="mobile-menu-toggle" (click)="toggleMobileMenu()" [class.open]="isMobileMenuOpen">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
  </div>
</header>

<!-- Mobile Navigation Menu -->
<div class="mobile-menu" [class.open]="isMobileMenuOpen" (click)="closeMobileMenu()">
  <div class="mobile-menu-content" (click)="$event.stopPropagation()">
    <nav class="mobile-nav">
      <a routerLink="/discovery" routerLinkActive="nav-active" class="mobile-nav-link" (click)="closeMobileMenu()">
        <i class="icon-discover"></i>
        DÃ©couvrir
      </a>
      <a class="mobile-nav-link" *ngIf="isAuthenticated" (click)="openQuests()">
        <i class="icon-quest"></i>
        QuÃªtes
      </a>
      <a routerLink="/favorites" routerLinkActive="nav-active" class="mobile-nav-link" *ngIf="isAuthenticated" (click)="closeMobileMenu()">
        <i class="icon-heart"></i>
        Favoris
        <span class="badge" *ngIf="favoriteCount > 0">{{ favoriteCount }}</span>
      </a>
      
      <!-- ğŸ“Š Analytics Premium - VIP et Legendary seulement -->
      <a routerLink="/analytics" routerLinkActive="nav-active" class="mobile-nav-link analytics-link" *ngIf="isAuthenticated && hasAnalyticsAccess" (click)="closeMobileMenu()">
        ğŸ“Š Analytics
        <span class="premium-badge">{{currentTier.badge}}</span>
      </a>
      
      <a routerLink="/subscription" routerLinkActive="nav-active" class="mobile-nav-link premium-link" (click)="closeMobileMenu()">
        ğŸ† Premium <span class="rotating-star">âœ¨</span>
      </a>
      
      <!-- Actions utilisateur dans le menu mobile -->
      <div class="mobile-user-actions">
        <ng-container *ngIf="!isAuthenticated">
          <button class="btn btn-primary mobile-login-btn" (click)="login(); closeMobileMenu()">
            <i class="icon-twitch"></i>
            Se connecter
          </button>
        </ng-container>
        
        <ng-container *ngIf="isAuthenticated && user">
          <div class="mobile-user-info">
            <div class="mobile-user-profile" (click)="openUserProfile(); closeMobileMenu()">
              <img [src]="user.avatar_url || getDefaultUserAvatar(user.username)" [alt]="user.username" (error)="onUserAvatarError($event, user.username)">
              <span>{{ user.username }}</span>
            </div>
            <button class="btn btn-ghost mobile-logout-btn" (click)="logout(); closeMobileMenu()">
              <i class="icon-logout"></i>
              DÃ©connexion
            </button>
          </div>
        </ng-container>
      </div>
    </nav>
  </div>
</div>

<!-- Main Content -->
<main class="main-content">
  <router-outlet></router-outlet>
</main>

<!-- Footer -->
<footer class="footer">
  <div class="footer-container">
    <div class="footer-brand">
      <span class="text-muted">Streamyscovery Â© 2025</span>
    </div>
    <div class="footer-links">
      <a href="javascript:void(0)" class="footer-link" (click)="openAbout()">Ã€ propos</a>
      <a href="javascript:void(0)" class="footer-link" (click)="openPrivacy()">ConfidentialitÃ©</a>
      <a href="javascript:void(0)" class="footer-link" (click)="openContact()">Contact</a>
    </div>
  </div>
</footer>

<!-- Composant de profil utilisateur -->
<app-user-profile #userProfile (openQuestsEvent)="openQuests()"></app-user-profile>

<!-- Composant de quÃªtes -->
<app-quests #questsComponent></app-quests>

<!-- Notifications de quÃªtes (toujours actif) -->
<app-quest-notification></app-quest-notification>

<!-- ===== MODALS FOOTER ===== -->

<!-- Modal Ã€ propos -->
<div *ngIf="showAboutModal" class="modal-overlay" (click)="closeAboutModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>ğŸŒŸ Ã€ propos de Streamyscovery</h2>
      <button class="modal-close" (click)="closeAboutModal()">âœ•</button>
    </div>
    <div class="modal-body">
      <p><strong>Streamyscovery</strong> est une plateforme innovante de dÃ©couverte de streamers Twitch.</p>
      <p>Notre mission est de connecter les spectateurs avec de nouveaux talents et d'aider les petits streamers Ã  grandir.</p>
      
      <div class="about-features">
        <h3>ğŸ¯ FonctionnalitÃ©s principales :</h3>
        <ul>
          <li>ğŸ” DÃ©couverte intelligente de streamers</li>
          <li>â¤ï¸ SystÃ¨me de favoris personnalisÃ©</li>
          <li>ğŸ† Gamification avec quÃªtes et achievements</li>
          <li>ğŸ“Š Analytics pour streamers</li>
          <li>ğŸŒŸ Support pour les micro-streamers</li>
        </ul>
      </div>
      
      <div class="about-version">
        <p><strong>Version:</strong> 2.0.0</p>
        <p>DÃ©veloppÃ© avec â¤ï¸ pour la communautÃ© streaming</p>
      </div>
    </div>
  </div>
</div>

<!-- Modal ConfidentialitÃ© -->
<div *ngIf="showPrivacyModal" class="modal-overlay" (click)="closePrivacyModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>ğŸ”’ Politique de ConfidentialitÃ©</h2>
      <button class="modal-close" (click)="closePrivacyModal()">âœ•</button>
    </div>
    <div class="modal-body">
      <h3>Protection de vos donnÃ©es</h3>
      <p>Chez Streamyscovery, nous prenons la confidentialitÃ© de vos donnÃ©es trÃ¨s au sÃ©rieux.</p>
      
      <div class="privacy-section">
        <h4>ğŸ“Š DonnÃ©es collectÃ©es :</h4>
        <ul>
          <li>Informations de profil Twitch (nom d'utilisateur, avatar)</li>
          <li>PrÃ©fÃ©rences de dÃ©couverte et favoris</li>
          <li>Statistiques d'utilisation anonymisÃ©es</li>
          <li>Progression des quÃªtes et achievements</li>
        </ul>
      </div>
      
      <div class="privacy-section">
        <h4>ğŸ›¡ï¸ Utilisation des donnÃ©es :</h4>
        <ul>
          <li>AmÃ©lioration de nos algorithmes de recommandation</li>
          <li>Personnalisation de votre expÃ©rience</li>
          <li>Analytics globales (donnÃ©es anonymisÃ©es)</li>
        </ul>
      </div>
      
      <div class="privacy-section">
        <h4>ğŸ” SÃ©curitÃ© :</h4>
        <p>Vos donnÃ©es sont stockÃ©es de maniÃ¨re sÃ©curisÃ©e et ne sont jamais vendues Ã  des tiers. Nous utilisons l'authentification OAuth de Twitch pour garantir la sÃ©curitÃ© de votre compte.</p>
      </div>
      
      <p class="privacy-contact">
        Pour toute question sur notre politique de confidentialitÃ© : 
        <strong>privacy&#64;streamyscovery.com</strong>
      </p>
    </div>
  </div>
</div>

<!-- Modal Contact -->
<div *ngIf="showContactModal" class="modal-overlay" (click)="closeContactModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>ğŸ“§ Nous Contacter</h2>
      <button class="modal-close" (click)="closeContactModal()">âœ•</button>
    </div>
    <div class="modal-body">
      <p>Nous sommes toujours ravis d'entendre notre communautÃ© !</p>
      
      <div class="contact-methods">
        <div class="contact-item">
          <h4>ğŸ’¬ Support technique</h4>
          <p><strong>Email:</strong> support&#64;streamyscovery.com</p>
          <p><strong>Temps de rÃ©ponse:</strong> 24-48h</p>
        </div>
        
        <div class="contact-item">
          <h4>ğŸ¤ Partenariats & Business</h4>
          <p><strong>Email:</strong> business&#64;streamyscovery.com</p>
          <p>Pour collaborations, sponsoring et partenariats</p>
        </div>
        
        <div class="contact-item">
          <h4>ğŸ’¡ Suggestions & Feedback</h4>
          <p><strong>Email:</strong> feedback&#64;streamyscovery.com</p>
          <p>Vos idÃ©es nous aident Ã  nous amÃ©liorer !</p>
        </div>
        
        <div class="contact-item">
          <h4>ğŸ® CommunautÃ©</h4>
          <p><strong>Discord:</strong> <a href="#" class="contact-link">discord.gg/streamyscovery</a></p>
          <p><strong>Twitter:</strong> <a href="#" class="contact-link">&#64;Streamyscovery</a></p>
        </div>
      </div>
      
      <div class="contact-footer">
        <p>ğŸ•’ <strong>Horaires support:</strong> Lun-Ven 9h-18h (CET)</p>
        <p>Pour les urgences techniques, mentionnez [URGENT] dans l'objet</p>
      </div>
    </div>
  </div>
</div>
