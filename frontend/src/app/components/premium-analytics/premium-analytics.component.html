<div class="premium-analytics-container">
  <!-- Header -->
  <div class="analytics-header">
    <div class="header-content">
      <h1>ğŸ“Š Analytics Premium</h1>
      <div class="upgrade-badge">Upgrade</div>
    </div>
    <p>DÃ©couvrez vos statistiques dÃ©taillÃ©es et votre progression</p>
  </div>

  <!-- Main Stats Cards -->
  <div class="main-stats-grid">
    <div class="stat-card">
      <div class="stat-icon">âš¡</div>
      <div class="stat-content">
        <div class="stat-value">{{ analytics?.totalXP || 0 | number }}</div>
        <div class="stat-label">XP Total</div>
        <div class="stat-change positive">+{{ analytics?.weeklyXpGain || 0 }} cette semaine</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">ğŸ¯</div>
      <div class="stat-content">
        <div class="stat-value">Niveau {{ analytics?.level || 1 }}</div>
        <div class="stat-label">Progression</div>
        <div class="stat-change positive">+{{ analytics?.currentXP || 0 }}/{{ analytics?.nextLevelXP || 100 }} XP</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">ğŸ”</div>
      <div class="stat-content">
        <div class="stat-value">{{ analytics?.streamsDiscovered || 0 }}</div>
        <div class="stat-label">Streams dÃ©couverts</div>
        <div class="stat-change positive">+{{ analytics?.weeklyDiscovered || 0 }} cette semaine</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">â¤ï¸</div>
      <div class="stat-content">
        <div class="stat-value">{{ analytics?.favoritesAdded || 0 }}</div>
        <div class="stat-label">Favoris ajoutÃ©s</div>
        <div class="stat-change positive">+{{ analytics?.weeklyFavorites || 0 }} cette semaine</div>
      </div>
    </div>
  </div>

  <!-- Progress Section -->
  <div class="analytics-grid">
    <!-- Weekly Progress Chart -->
    <div class="analytics-card chart-card">
      <div class="card-header">
        <h3>ğŸ“Š Progression XP par jour</h3>
        <div class="period-selector">
          <button class="period-btn active">7J</button>
          <button class="period-btn">30J</button>
        </div>
      </div>
      <div class="chart-container">
        <canvas #weeklyChart class="chart"></canvas>
        <!-- Labels des jours -->
        <div class="chart-labels">
          <span *ngFor="let day of weeklyProgress" class="chart-label">{{ day.day }}</span>
        </div>
        <!-- DonnÃ©es au survol -->
        <div class="chart-values">
          <div *ngFor="let day of weeklyProgress" class="chart-value" 
               [style.height.%]="getChartHeight(day.xp)">
            <span class="value-label">{{ day.xp }} XP</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Categories -->
    <div class="analytics-card">
      <div class="card-header">
        <h3>ğŸ® CatÃ©gories PrÃ©fÃ©rÃ©es</h3>
        <span class="percentage">100%</span>
      </div>
      <div class="categories-list">
        <div *ngFor="let category of topCategories; let i = index" class="category-item">
          <div class="category-icon">ğŸ®</div>
          <div class="category-info">
            <span class="category-name">{{ category.name }}</span>
            <div class="category-bar">
              <div class="category-progress" [style.width.%]="category.percentage"></div>
            </div>
          </div>
          <span class="category-count">{{ category.count }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Monthly Summary -->
  <div class="analytics-card monthly-summary">
    <div class="card-header">
      <h3>ğŸ† RÃ©sumÃ© du Mois</h3>
      <div class="month-selector">
        <button class="month-btn">â† Juil.</button>
        <span class="current-month">AoÃ»t 2025</span>
        <button class="month-btn">Sept. â†’</button>
      </div>
    </div>
    <div class="summary-grid">
      <div class="summary-item">
        <div class="summary-icon">ğŸ”</div>
        <div class="summary-content">
          <div class="summary-value">{{ monthlyStats?.streamsDiscovered || 0 }}</div>
          <div class="summary-label">Streams dÃ©couverts</div>
          <div class="summary-subtitle">+{{ monthlyStats?.streamsIncrease || 0 }}% vs mois dernier</div>
        </div>
      </div>

      <div class="summary-item">
        <div class="summary-icon">â­</div>
        <div class="summary-content">
          <div class="summary-value">{{ monthlyStats?.questsCompleted || 0 }}</div>
          <div class="summary-label">QuÃªtes terminÃ©es</div>
          <div class="summary-subtitle">+{{ monthlyStats?.questsIncrease || 0 }}% vs mois dernier</div>
        </div>
      </div>

      <div class="summary-item">
        <div class="summary-icon">ğŸ¯</div>
        <div class="summary-content">
          <div class="summary-value">{{ monthlyStats?.xpGained || 0 | number }}</div>
          <div class="summary-label">XP gagnÃ©s</div>
          <div class="summary-subtitle">+{{ monthlyStats?.xpIncrease || 0 }}% vs mois dernier</div>
        </div>
      </div>

      <div class="summary-item">
        <div class="summary-icon">ğŸ…</div>
        <div class="summary-content">
          <div class="summary-value">{{ monthlyStats?.badgesEarned || 0 }}</div>
          <div class="summary-label">Badges obtenus</div>
          <div class="summary-subtitle">+{{ monthlyStats?.badgesIncrease || 0 }}% vs mois dernier</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Achievements -->
  <div class="analytics-card achievements">
    <div class="card-header">
      <h3>ğŸ† SuccÃ¨s RÃ©cents</h3>
      <span class="achievements-count">{{ recentAchievements?.length || 0 }} succÃ¨s</span>
    </div>
    <div class="achievements-list">
      <div *ngFor="let achievement of recentAchievements" class="achievement-item">
        <div class="achievement-icon">{{ achievement.icon }}</div>
        <div class="achievement-info">
          <h4>{{ achievement.title }}</h4>
          <p>{{ achievement.description }}</p>
        </div>
        <div class="achievement-status">
          <span class="status-icon">âœ…</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Premium Features -->
  <div class="analytics-card premium-features">
    <div class="card-header">
      <h3>âœ¨ FonctionnalitÃ©s Premium Actives</h3>
      <span class="premium-badge">LÃ©gendaire</span>
    </div>
    <div class="features-grid">
      <div class="feature-item active">
        <span class="feature-icon">âœ…</span>
        <span class="feature-text">Boost XP +15%</span>
      </div>
      <div class="feature-item active">
        <span class="feature-icon">âœ…</span>
        <span class="feature-text">10 quÃªtes quotidiennes (+3)</span>
      </div>
      <div class="feature-item active">
        <span class="feature-icon">âœ…</span>
        <span class="feature-text">7 quÃªtes hebdomadaires (+2)</span>
      </div>
      <div class="feature-item active">
        <span class="feature-icon">âœ…</span>
        <span class="feature-text">6 quÃªtes mensuelles (+3)</span>
      </div>
      <div class="feature-item active">
        <span class="feature-icon">âœ…</span>
        <span class="feature-text">Analytics avancÃ©es</span>
      </div>
      <div class="feature-item active">
        <span class="feature-icon">âœ…</span>
        <span class="feature-text">Badge utilisateur personnalisÃ©</span>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="loading-spinner"></div>
    <p>Chargement des analytics...</p>
  </div>
</div>
